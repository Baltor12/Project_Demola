<!DOCTYPE html>
<html lang="en">
<head>



	<link rel="stylesheet" href="js/controllers/reset.css">
	<link rel="stylesheet" type="text/css" href="js/controllers/main.css">


<!-- <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script> -->


	

<script type="text/javascript" src="js/controllers/angular.js"></script>
<script type="text/javascript" src="js/controllers/angular-fusioncharts.min.js"></script>
<script type="text/javascript" src="js/controllers/fusioncharts.js"></script>
<script type="text/javascript" src="js/controllers/fusioncharts.widgets.js"></script>
<script type="text/javascript" src="js/controllers/fusioncharts.theme.fint.js"></script>
<script> var elementDragged = null;	var right_global;</script>
<script>var loggedinUser = <%- JSON.stringify(user) %>;</script>
<script src="js/controllers/demo.js"></script>
<script type="text/javascript" src="js/controllers/test.js"></script>
<script type="text/javascript" src="js/controllers/svg_script.js"></script>
<script src="/socket.io/socket.io.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    <script src="js/controllers/jquery.ui.core.js"></script>
    <script src="js/controllers/jquery.ui.widget.js"></script>
    <script src="js/controllers/jquery.ui.mouse.js"></script>
    <script src="js/controllers/jquery.ui.draggable.js"></script>
    <script src="js/controllers/jquery-collision.min.js"></script>
    <script src="js/controllers/jquery-ui-draggable-collision.js"></script>

<script src="js/controllers/CollapsibleLists.js"></script>



<script>

function menu(x, y,i) {
  i.top = y + "px";
  i.left = x + "px";
  i.visibility = "visible";
  i.opacity = "1";
}

</script>


<script>
function showCustomMenu(currElement) {

		right_global = currElement;
		var e = window.event;
		var i = document.getElementById("menu").style;
		var posX = e.clientX;
		var posY = e.clientY;
		menu(posX, posY,i);
		e.preventDefault();


/*
    var rightclick;
    var e = window.event;
	e.preventDefault();
	test = currElement;
    if (e.which) rightclick = (e.which == 3);
    else if (e.button) rightclick = (e.button == 2);
    alert(rightclick); // true or false, you can trap right click here by if comparison
*/	
//<div class="top" oncontextmenu="javascript:alert('success!');return false;">
	
}


</script>




<script>
function removeCustomMenu(currElement) {

//test = currElement;
right_global.remove();

		var e = window.event;
		var i = document.getElementById("menu").style;
    i.opacity = "0";
    setTimeout(function() {
      i.visibility = "hidden";
    });
	
	
right_global = null;

/*
    var rightclick;
    var e = window.event;
	e.preventDefault();
	test = currElement;
    if (e.which) rightclick = (e.which == 3);
    else if (e.button) rightclick = (e.button == 2);
    alert(rightclick); // true or false, you can trap right click here by if comparison
*/	
//<div class="top" oncontextmenu="javascript:alert('success!');return false;">
	
}


</script>



<script>


function showDoubleMenu(currElement) {
/*
		right_global = currElement;
		var e = window.event;
		//var i = document.getElementById("menu1").style;
		var i = document.getElementById("stylized").style;
		var posX = e.clientX;
		var posY = e.clientY;
		menu(posX, posY,i);
		e.preventDefault();
*/
		
}


</script>




<script>
var xsd;
var mychart;
//var app = angular.module("myApp", []);
var app = angular.module("myApp", ["ng-fusioncharts","test","app"]);
app.controller('MyController', function($scope) {
    //Define the `myDataSource` scope variable.
    $scope.myDataSource = {
        chart: {
            //Define the chart attributes.
			"caption": "Monthly revenue for last year",
            "subCaption": "Harry's SuperMart",
            "xAxisName": "Month",
            "yAxisName": "Revenues (In USD)",
            "theme": "fint"
        },
        data: [
            //Define the data labels and data values for the data plots.
			{
               "label": "Jan",
               "value": "420000"
            },
            {
               "label": "Feb",
               "value": "810000"
            },
            {
               "label": "Mar",
               "value": "720000"
            },
            {
               "label": "Apr",
               "value": "550000"
            },
            {
               "label": "May",
               "value": "910000"
            },
            {
               "label": "Jun",
               "value": "510000"
            },
            {
               "label": "Jul",
               "value": "680000"
            },
            {
               "label": "Aug",
               "value": "620000"
            },
            {
               "label": "Sep",
               "value": "610000"
            },
            {
               "label": "Oct",
               "value": "490000"
            },
            {
               "label": "Nov",
               "value": "900000"
            },
            {
               "label": "Dec",
               "value": "730000"
            }
        ]
    };
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
		$scope.updateMyChartData = function() {
	
//angular.element(document.getElementById('drop-target-one')).append($compile("<div id='firstChart' fusioncharts=''  width='600' height='400'  type='realtimeline'  dataSource='" + JSON.stringify(scope.myRealTimeData) +"'> </div>")(scope));			



/*
angular.injector(['ng', 'myApp']).invoke(function ($compile) {
    // Create a scope.
    var $scope = angular.element(document.body).scope();
    // Specify what it is we'll be compiling.
    var to_compile = '<div ng-attr-tooltip="test">Cancel</div>';
    // Compile the tag, retrieving the compiled output.
    var $compiled = $compile(to_compile)($scope);
    // Ensure the scope and been signalled to digest our data.
    $scope.$digest();
    // Append the compiled output to the page.
    $compiled.appendTo(document.body);
  });

*/





/*
				var $injector = angular.injector(['ng', 'myApp']);
				  $injector.invoke(function($rootScope, $compile) {
angular.element(document.getElementById('drop-target-one')).append($compile("<div id='firstChart' fusioncharts=''  width='600' height='400'  type='realtimeline'  dataSource='" + JSON.stringify($scope.myRealTimeData) +"'> </div>")($scope));
				  });
*/


	
					//var test = {label: "Test", value: "520000"};
					//$scope.myDataSource.data.push(test);
					/*
					$scope.myDataSource.data[2].label = "This Label is Updated";
					$scope.myDataSource.data[2].value = "420000";
					$scope.myDataSource.data[3].label = "This is updated as well";
					$scope.myDataSource.data[3].value = "210000";
					*/		
		}
		
		$scope.updateMyChartData_new = function() {
		
					var test = {label:"13"};
					$scope.categories[0]["category"].push(test);
					$scope.dataset[0].data.push({"value": "10400"});
					$scope.dataset[1].data.push({"value": "15400"});					
					
					var test = {label:"14"};
					$scope.categories[0]["category"].push(test);
					$scope.dataset[0].data.push({"value": "10400"});
					$scope.dataset[1].data.push({"value": "15400"});
					
					var test = {label:"15"};
					$scope.categories[0]["category"].push(test);					
					$scope.dataset[0].data.push({"value": "10400"});
					$scope.dataset[1].data.push({"value": "15400"});
					
					/*
					$scope.myDataSource.data[2].label = "This Label is Updated";
					$scope.myDataSource.data[2].value = "420000";
					$scope.myDataSource.data[3].label = "This is updated as well";
					$scope.myDataSource.data[3].value = "210000";
					*/		
		}
		
		$scope.updateMyChartData_real = function(){
		
		
		               function addLeadingZero(num){
                   return (num <= 9)? ("0"+num) : num;
               }
			   
		function updateData() {
					mychart = FusionCharts("chartobject-1");
                        currDate = new Date(),
                        label = addLeadingZero(currDate.getHours()) + ":" +
                                addLeadingZero(currDate.getMinutes()) + ":" +
                                addLeadingZero(currDate.getSeconds()),
                        // Get random number between 35.25 & 35.75 - rounded to 2 decimal places
                        randomValue = Math.floor(Math.random() * 50) / 100 + 35.25,
                        // Build Data String in format &label=...&value=...
                        strData = "&label=" + label 
                                    + "&value=" 
                                    + randomValue;
                    // Feed it to chart.
                    mychart.feedData(strData);
			}
			
			               var myVar = setInterval(function () {
                   updateData();
               }, 2000);
			
			//$scope.myRealTimeData["dataset"][0]["data"].push({"value": "37.5"});
			//mychart.setJSONData({"value": "37.5"});
			//$scope.myRealTimeData["dataset"][0]["data"].push({"value": "35.5"});			
			//&value=33;			
		}
		
		
		
		
		
//////////////////////////////////////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
/*
$scope.attrs = {

    "caption": "Sales Comparison: 2013 versus 2014",
    "subCaption": "Harryâ€™ s SuperMart",
    "numberprefix": "$",
    "plotgradientcolor": "",
    "bgcolor": "FFFFFF",
    "showalternatehgridcolor": "0",
    "divlinecolor": "CCCCCC",
    "showvalues": "0",
    "showcanvasborder": "0",
    "canvasborderalpha": "0",
    "canvasbordercolor": "CCCCCC",
    "canvasborderthickness": "1",
    "yaxismaxvalue": "30000",
    "captionpadding": "30",
    "linethickness": "3",
    "yaxisvaluespadding": "15",
    "legendshadow": "0",
    "legendborderalpha": "0",
    "palettecolors": "#f8bd19,#008ee4,#33bdda,#e44a00,#6baa01,#583e78",
    "showborder": "0"
};

$scope.categories = [{
    "category": [{
        "label": "1"
    }, {
        "label": "2"
    }, {
        "label": "3"
    }, {
        "label": "4"
    }, {
        "label": "5"
    }, {
        "label": "6"
    }, {
        "label": "7"
    }, {
        "label": "8"
    }, {
        "label": "9"
    }, {
        "label": "10"
    }, {
        "label": "11"
    }, {
        "label": "12"
    }]
}];

$scope.dataset = [{
        "seriesname": "2013",
        "data": [{
            "value": "22400"
        }, {
            "value": "24800"
        }, {
            "value": "21800"
        }, {
            "value": "21800"
        }, {
            "value": "24600"
        }, {
            "value": "27600"
        }, {
            "value": "2+6800"
        }, {
            "value": "27700"
        }, {
            "value": "23700"
        }, {
            "value": "25900"
        }, {
            "value": "26800"
        }, {
            "value": "24800"
        }]
    },

    {
        "seriesname": "2012",
        "data": [{
            "value": "10000"
        }, {
            "value": "11500"
        }, {
            "value": "12500"
        }, {
            "value": "15000"
        }, {
            "value": "16000"
        }, {
            "value": "17600"
        }, {
            "value": "18800"
        }, {
            "value": "19700"
        }, {
            "value": "21700"
        }, {
            "value": "21900"
        }, {
            "value": "22900"
        }, {
            "value": "20800"
        }]
    }
];
*/
//////////////////////////////////////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////////////////////////////////////


	$scope.myRealTimeData = {
    'chart': {
        'caption': 'Real',
        'subCaption': 'LABEL',
        'xAxisName': 'x-axis',
        'yAxisName': 'y-axis',
        'numberPrefix': '$',
        'refreshinterval': '5',
        'yaxisminvalue': '35',
        'yaxismaxvalue': '36',
        'numdisplaysets': '10',
        'labeldisplay': 'rotate',
        'showValues': '0',
        'showRealTimeValue': '0',
        'theme': 'fint'
    },
    'categories': [
        {
            'category': [
                {
                    'label': 'Day Start'
                }
            ]
        }
    ],
    'dataset': [
        {
            'data': [
                {
                    'value': '37.27'
                }
            ]
        }
    ]
};



//////////////////////////////////////////////////////////////////////////////////////////////////////////////




$scope.myevents = {
    dataplotclick: function (ev, props) {
        $scope.$apply(function () {
            $scope.selectedValue = props.displayValue;
        });
    },
	chartClick: function (eventObj, argsObj) {
                console.log('Chart clicked at ' + argsObj.chartX + ',' + argsObj.chartY);
    }
	
/*
	"initialized": function (e) {
               function addLeadingZero(num){
                   return (num <= 9)? ("0"+num) : num;
               }
               function updateData() {
                    // Get reference to the chart using its ID
                    var chartRef = FusionCharts("chartobject-1"),
                        // We need to create a querystring format incremental update, containing
                        // label in hh:mm:ss format
                        // and a value (random).
                        currDate = new Date(),
                        label = addLeadingZero(currDate.getHours()) + ":" +
                                addLeadingZero(currDate.getMinutes()) + ":" +
                                addLeadingZero(currDate.getSeconds()),
                        // Get random number between 35.25 & 35.75 - rounded to 2 decimal places
                        randomValue = Math.floor(Math.random()     
                                                  * 50) / 100 + 35.25,
                        // Build Data String in format &label=...&value=...
                        strData = "&label=" + label 
                                    + "&value=" 
                                    + randomValue;
                    // Feed it to chart.
                    chartRef.feedData(strData);
                }

               var myVar = setInterval(function () {
                   updateData();
               }, 5000);
           }
*/
	
	
}
	
	
});



</script>


<script>

function setAllDrags() {
//var $draggables = $("li.drag-elements-new-li");
var $draggables_p = $("#drop-target-one");
var $draggables = $draggables_p.children();
var id, $draggableItem;
//var $my_test_array = new Array();
for (var i = 0; i < $draggables.length; i++) {
        //$draggableItem = $draggables.eq(i);
        //id = $draggableItem.attr("id");
			
			var $my_test_array = new Array();
			
		for(var j=0;j<$draggables.length; j++){
			
			//$draggableItem = $draggables.eq(j);
			
			if($draggables.eq(i)[0] != $draggables.eq(j)[0] ){
				$draggableItem = $draggables.eq(j);
				$my_test_array.push($draggableItem);
			}
			
		}
		
		$($draggables.eq(i)).draggable({
//            obstacle: "li.obstacle[id!=\"" + id + "\"]",
			obstacle: $my_test_array,
            preventCollision: true,
			containment: "#drop-target-one"	,
			stop: function(event, ui)
			{
				//alert('stop: dropped  ');
				// Check value of ui.helper.data('dropped') and handle accordingly...
			},
			drag: function(event, ui)
			{
			
				socket.emit('moveObject', {'loggedinUser': loggedinUser, currentId:this.id, positionX:ui.position.left, positionY:ui.position.top});	
					/*
					  var xhttp = new XMLHttpRequest();
					  xhttp.open('POST', '/moveObject', true);
					  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
					  xhttp.send("loggedinUser=" + loggedinUser + "&currentId=" + this.id + "&positionX=" + ui.position.left+ "&positionY=" + ui.position.top);  
					*/

			}
	
        });


		
	
}


}

</script>


<script>

  var socket = io();
socket.on("tweet", function(notificationData) {
    // todo: add the tweet as a DOM node
	
//	mychart = FusionCharts("chartobject-1");
//	mychart.feedData(notificationData);
	//console.log("tweet from", notificationData);
	
});

socket.on("added_Html", function(notificationData) {

/*
var str2DOMElement = function(html) {
    var frame = document.createElement('iframe');
    frame.style.display = 'none';
    document.body.appendChild(frame);             
    frame.contentDocument.open();
    frame.contentDocument.write(html);
    frame.contentDocument.close();
    var el = frame.contentDocument.body.firstChild;
    document.body.removeChild(frame);
    return el;
}
*/
	
	if(notificationData.loggedinUser != loggedinUser){
			//console.log(notificationData.loggedinUser);
			console.log(notificationData.currentHtml);				
			var $htmlObject = $(notificationData.currentHtml);
			$("#drop-target-one").append($htmlObject);
			setAllDrags();
			
			//var markup = notificationData.currentHtml;
			//var el = str2DOMElement(markup);

			//var nodes_test = document.getElementById("drop-target-one");
			//nodes_test.appendChild(el);
			
	}
	
	
});


socket.on("moved_Html", function(notificationData) {

	if(notificationData.loggedinUser != loggedinUser){
	
			console.log(notificationData);		
//loggedinUser=" + loggedinUser + "&currentId=" + this.id + "&positionX=" + ui.position.left+ "&positionY=" + ui.position.top;
			var nodes_test = document.getElementById(notificationData.currentId);
				nodes_test.style.top=(notificationData.positionY)+ "px";
				nodes_test.style.left=(notificationData.positionX)+ "px";				
			
	}
	

	
});




</script>







<!--
<script type="text/javascript">
var xx;
var test = {label: "Test", value: "520000"};
  FusionCharts.ready(function(){
    //var revenueChart = new FusionCharts({
	  xx = new FusionCharts({
        "type": "column2d",
        "renderAt": "chartContainer",
        "width": "400",
        "height": "300",
        "dataFormat": "json",
        "dataSource":  {
          "chart": {
            "caption": "Monthly revenue for last year",
            "subCaption": "Harry's SuperMart",
            "xAxisName": "Month",
            "yAxisName": "Revenues (In USD)",
            "theme": "fint"
         },
         "data": [
            {
               "label": "Jan",
               "value": "420000"
            },
            {
               "label": "Feb",
               "value": "810000"
            },
            {
               "label": "Mar",
               "value": "720000"
            },
            {
               "label": "Apr",
               "value": "550000"
            },
            {
               "label": "May",
               "value": "910000"
            },
            {
               "label": "Jun",
               "value": "510000"
            },
            {
               "label": "Jul",
               "value": "680000"
            },
            {
               "label": "Aug",
               "value": "620000"
            },
            {
               "label": "Sep",
               "value": "610000"
            },
            {
               "label": "Oct",
               "value": "490000"
            },
            {
               "label": "Nov",
               "value": "900000"
            },
            {
               "label": "Dec",
               "value": "730000"
            }
          ]
      }

  });

  //revenueChart.render();
  xx.render();
  //xx.args.dataSource;
})


</script>


<script>
function myFunction() {

var xx;
var test = {label: "Test", value: "520000"};
  FusionCharts.ready(function(){
    //var revenueChart = new FusionCharts({
	  xx = new FusionCharts({
        "type": "column2d",
        "renderAt": "chartContainer",
        "width": "400",
        "height": "300",
        "dataFormat": "json",
        "dataSource":  {
          "chart": {
            "caption": "Monthly revenue for last year",
            "subCaption": "Harry's SuperMart",
            "xAxisName": "Month",
            "yAxisName": "Revenues (In USD)",
            "theme": "fint"
         },
         "data": [
            {
               "label": "Jan",
               "value": "420000"
            },
            {
               "label": "Feb",
               "value": "810000"
            },
            {
               "label": "Mar",
               "value": "720000"
            },
            {
               "label": "Apr",
               "value": "550000"
            },
            {
               "label": "May",
               "value": "910000"
            },
            {
               "label": "Jun",
               "value": "510000"
            },
            {
               "label": "Jul",
               "value": "680000"
            },
            {
               "label": "Aug",
               "value": "620000"
            },
            {
               "label": "Sep",
               "value": "610000"
            },
            {
               "label": "Oct",
               "value": "490000"
            },
            {
               "label": "Nov",
               "value": "900000"
            },
            {
               "label": "Dec",
               "value": "730000"
            },
			{
               "label": "Test",
               "value": "950000"
            }
			
          ]
      }

  });

  //revenueChart.render();
  xx.render();
  //xx.args.dataSource;
})


}
</script>

-->


	<meta charset="utf-8">
	<title>Factory Visualiztion</title>
	

</head>
<body id="my_body"  ng-app="myApp" ng-controller="MyController">




<div class="left">

<ul class="collapsibleList">
  <li>
    Elements
			<ul id="drag-elements1" class="drag-elements">
				<li id="aaa" class="drag-elements-li obstacle" draggable="true">Element One</li>
				<li id="bbb" class="drag-elements-li obstacle" draggable="true">Element Two</li>
				<li class="drag-elements-li"  draggable="true">Element Three</li>
				<li class="drag-elements-li"  draggable="true">Element Four</li>
				<li class="drag-elements-li"  draggable="true">Element Five</li>
				
			</ul>
  </li>

</ul>

<ul class="collapsibleList">
  <li>
    Elements SVG
			<ul>
				<svg-icon p="bookmark" draggable="true"></svg-icon>
				<svg-icon p="calendar" draggable="true"></svg-icon>
				<svg-icon p="camera" draggable="true"></svg-icon>
				<svg-icon p="chat" draggable="true"></svg-icon>
				<svg-icon p="check" draggable="true"></svg-icon>
				
			</ul>
  </li>

</ul>


			
			<div fusioncharts
				width='200'
				height='200'
				type='realtimeline'
				events='myevents'
				dataSource='{{myRealTimeData}}'
				draggable='true'>
			</div>

				


</div>
	
	
<div id="main_ui" class="main">


			<div id="drop-target-one">

			</div>

			
</div>	

<div id="menu">
  <a onclick = "removeCustomMenu(this)">
    <img src="http://puu.sh/nr60s/42df867bf3.png"/> Delete Element
  </a>
  <a  onclick = "removeCustomMenu(this)">
    <img src="http://puu.sh/nr5Z6/4360098fc1.png" /> Option 1
  </a>
  <hr />
  <a  onclick = "showDoubleMenu(this)">
    <i class="fa fa-fort-awesome"></i> Option 2
  </a >
  <a  onclick = "removeCustomMenu(this)">
    <i class="fa fa-flag"></i> Option 3
  </a>
</div>
	
	
<div id="menu1">
  <a>
    <img src="http://puu.sh/nr60s/42df867bf3.png"/> Delete Element
  </a>
  <a>
    <img src="http://puu.sh/nr5Z6/4360098fc1.png" /> Option 1
  </a>
  <hr />
  <a>
    <i class="fa fa-fort-awesome"></i> Option 2
  </a >
  <a>
    <i class="fa fa-flag"></i> Option 3
  </a>
</div>
	
	
<form id='sampleform' method='post' action='' >
   <p>
   Name: <input type='text' name='Name' />
   </p>
   <p>
   Email: <input type='text' name='Email' />
   </p>
   <p>
   <input type='submit' name='Submit' value='Submit' />
   </p>
</form>


	
<!-- <button onclick="myFunction()">Click me</button> -->

</body>


<script>
//CollapsibleLists.applyTo(document.getElementById('drag-elements'));
CollapsibleLists.apply();
</script>


</html>



<script>

var menu_item = document.getElementById("menu").style;
document.addEventListener('click', function(e) {
    menu_item.opacity = "0";
    setTimeout(function() {
      menu_item.visibility = "hidden";
    });
  }, false);

  
</script>




<script>

/*
var gg = document.getElementById("main_ui");


gg.onclick = function(){

		var i = document.getElementById("stylized").style;
    i.opacity = "0";
    setTimeout(function() {
      i.visibility = "hidden";
    });


}

*/

</script>

